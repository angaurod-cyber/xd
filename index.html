<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Descargas SB3 - Angel</title>
  <style>
    body {
      font-family: monospace;
      background: #111;
      color: #0f0;
      padding: 2em;
    }
    h1 {
      color: #0ff;
    }
    input, button {
      font-family: monospace;
      padding: 0.5em;
      margin-right: 0.5em;
      background: #222;
      color: #0f0;
      border: 1px solid #0f0;
    }
    ul {
      list-style: none;
      padding: 0;
    }
    li {
      margin: 0.5em 0;
    }
    a {
      color: #0f0;
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <h1>üß† Descargas SB3 - Angel</h1>
  <p>üîó Pega el link del repositorio GitHub (ej: https://github.com/AngelDev/sb3-projects)</p>
  <input type="text" id="repoUrl" placeholder="https://github.com/usuario/repositorio">
  <button onclick="cargarVersiones()">Cargar versiones</button>

  <ul id="versionList">
    <!-- Las versiones aparecer√°n aqu√≠ -->
  </ul>

  <script>
    function cargarVersiones() {
      const input = document.getElementById("repoUrl").value.trim();
      const list = document.getElementById("versionList");
      list.innerHTML = "<li>Cargando...</li>";

      const match = input.match(/^https:\/\/github\.com\/([^\/]+)\/([^\/]+)(\/.*)?$/);
      if (!match) {
        list.innerHTML = "<li>‚ùå URL inv√°lida</li>";
        return;
      }

      const owner = match[1];
      const repo = match[2];

      fetch(`https://api.github.com/repos/${owner}/${repo}/contents`)
        .then(res => res.json())
        .then(files => {
          list.innerHTML = "";
          files
            .filter(file => file.name.endsWith(".sb3"))
            .sort()
            .forEach(file => {
              const li = document.createElement("li");
              const a = document.createElement("a");
              a.href = file.download_url;
              a.textContent = `Versi√≥n ${file.name.replace(".sb3", "")}`;
              a.download = file.name;
              li.appendChild(a);
              list.appendChild(li);
            });

          if (list.children.length === 0) {
            list.innerHTML = "<li>No se encontraron archivos .sb3</li>";
          }
        })
        .catch(err => {
          console.error("‚ùå Error al cargar archivos:", err);
          list.innerHTML = "<li>Error al cargar versiones.</li>";
        });
    }
  </script>
</body>
</html>
